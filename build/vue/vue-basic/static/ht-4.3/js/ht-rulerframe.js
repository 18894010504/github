!function(Y,G){"use strict";var H="position",C="absolute",T="relative",U="px",A="left",V="right",j="top",K="bottom",g="display",$="none",f="block",n=ht.Default,c=n.getInternal(),k=Math.floor,s=Math.ceil,R=Math.PI,u=null,o=Y.parseInt,i=function(U){return U.getContext("2d")},y=function(){return document},S=function(k){return y().createElement(k)},E=function(){return S("div")},W=function(){return S("canvas")},v=function(G,V,m){G.style.setProperty(V,m,u)},L=function(c,Q,I){n.def(ht.widget[c],Q,I)},w=function(x,D){x.appendChild(D)},d=function(J,y){J.removeChild(y)},D=function(U,d,v,x){U.addEventListener(d,v,!!x)},m=function(u,S,H,E){u.removeEventListener(S,H,!!E)};ht.widget.RulerFrame=function(_){var V=this,g=V._view=E(),m=V.$1k=W(),u=V.$2k=W(),X=V.$3k=W(),y=V.$4k=W();V._defaultRulerConfig={size:20,borderWidth:1,borderStyle:"solid",borderColor:"#888",defaultMajorTickSpacing:50,minMajorTickSpacing:10,minPhysicalMajorTickSpacing:40,maxPhysicalMajorTickSpacing:100,tickSpacingAdaptable:!0,majorTickTextFont:"12px Arial",majorTickTextColor:"#666",majorTickColor:"#888",minorTickColor:"#ccc",background:"rgba(0,0,0,0)",guideColor:"rgb(0, 173, 239)",guideWidth:2,guideVisible:!1,guideTipVisible:!1,guideTipBorderColor:"#666",guideTipTextColor:"#666",guideTipTextFont:"12px Arial",guideTipBackground:"#fff"},V._topRulerConfig={visible:!0},V._rightRulerConfig={visible:!1},V._bottomRulerConfig={visible:!1},V._leftRulerConfig={visible:!0},w(g,m),w(g,X),w(g,u),w(g,y),v(g,H,T),v(g,"box-sizing","border-box"),v(g,"-moz-box-sizing","border-box"),v(m,H,C),v(u,H,C),v(X,H,C),v(y,H,C),V.$14k=function(){V.$13k=1,V.iv()},V.$15k=function(I){if(V._topRulerConfig.guideVisible||V._rightRulerConfig.guideVisible||V._bottomRulerConfig.guideVisible||V._leftRulerConfig.guideVisible||V._defaultRulerConfig.guideVisible||(V._topRulerConfig.guideTipVisible||V._rightRulerConfig.guideTipVisible||V._bottomRulerConfig.guideTipVisible||V._leftRulerConfig.guideTipVisible||V._defaultRulerConfig.guideTipVisible)&&V._component){var L=g.getBoundingClientRect();V.$16k={x:I.clientX-L.left,y:I.clientY-L.top},V.$5k()}},V.setComponent(_)},L("RulerFrame",G,{ms_v:1,ms_fire:1,ms_ac:["defaultRulerConfig","topRulerConfig","rightRulerConfig","bottomRulerConfig","leftRulerConfig","component"],setComponent:function(c){var s=this,f=s._component,X=s.getView();if(X){if(s._component=c,s.fp("component",f,c),f){var p=s.getComponentView(f);d(X,p),m(X,"mousemove",s.$15k),s.removeComponentPropertyChangeListener(f,s.$14k)}if(c){var o=s.getComponentView(c);w(X,o),v(o,H,C),D(X,"mousemove",s.$15k),s.addComponentPropertyChangeListener(c,s.$14k)}}},addComponentPropertyChangeListener:function(v,t){v&&v.mp&&v.mp(t)},removeComponentPropertyChangeListener:function(a,e){a&&a.ump&&a.ump(e)},getComponentHZoom:function(U){return U&&U.getZoom?U.getZoom():1},getComponentVZoom:function(k){return k&&k.getZoom?k.getZoom():1},getComponentViewRect:function($){return $&&$.getViewRect?$.getViewRect():void 0},getComponentView:function(c){return c&&c.getView?c.getView():c},invalidateComponent:function(r){r&&r.iv&&r.iv()},validateComponent:function(G){G&&G.validate&&G.validate()},$7k:function(S,x,w,m,J,B,j,I,t,y,n,s){if(x.visible){var o=this._defaultRulerConfig,K="borderStyle",d="borderColor",L="borderWidth",V="background",q=x[K]||o[K],_=x[d]||o[d],U=x[L]||o[L],O=x.size!=u?x.size:o.size,r=x[V]||o[V],h=O+U,T=this.$6k(U,q,_,S,w,J,h,j,I,t,y,n,s);v(S,J,"0px"),B?c.setCanvas(S,m-T,O):c.setCanvas(S,O,m-T),v(S,"background",r),v(S,g,f)}else v(S,g,$),v(this.getComponentView(this._component),J,"0px")},$6k:function(T,i,q,g,V,H,D,C,J,Z,t,O,W){var k=0;return v(g,V,T+"px "+i+" "+q),v(this.getComponentView(this._component),H,D+U),C?(v(g,J,Z+U),k+=Z):v(g,J,"0px"),t?(v(g,O,W+U),k+=W):v(g,O,"0px"),k},validateImpl:function(){var r=this,Z=r._component,L=r.$1k,h=r.$2k,N=r.$3k,$=r.$4k,_=r._view,g=r._defaultRulerConfig,a=r._topRulerConfig,D=r._rightRulerConfig,F=r._bottomRulerConfig,I=r._leftRulerConfig,B=g.size;if(_&&Z){var i=a.size!=u?a.size:B,R=D.size!=u?D.size:B,x=F.size!=u?F.size:B,l=I.size!=u?I.size:B;r.$7k(L,a,"border-bottom",_.offsetWidth,j,!0,I.visible,A,l,D.visible,V,R),r.$7k(h,D,"border-left",_.offsetHeight,V,!1,a.visible,j,i,F.visible,K,x),r.$7k(N,F,"border-top",_.offsetWidth,K,!0,I.visible,A,l,D.visible,V,R),r.$7k($,I,"border-right",_.offsetHeight,A,!1,a.visible,j,i,F.visible,K,x),r.$13k?delete r.$13k:r.invalidateComponent(Z),r.validateComponent(Z),r.$5k()}},$5k:function(){function c(V,L,K,M,X,A){if(L.visible){var c=i(V),q=L[Y]||Q,z=L[o]!=u?L[o]:y,x=L[N]||v,T=L[W]||_,k=L.size!=u?L.size:$,Vc=L[B]||U,wb=L[s]||r,Hi=L[I]||G,wi=L[p]!=u?L[p]:n,bb=L[d]!=u?L[d]:D,Ci=L[F]!=u?L[F]:w,In=L[b]!=u?L[b]:C,Wc=L[a]!=u?L[a]:J,Fe=L[R]!=u?L[R]:H,Ki=L[j]||Hg,Gr=L[Z]||Bl;z&&(q=t[A]=t.$8k(t[A]||q,L[S]||P,L[f]||e,M?O:h,wb)),K.call(t,c,m,E,g,l,k,M?O:h,q,x,T,X,Vc,Hi);var Dk=t.$16k;(wi||bb)&&Dk&&(M?t.$9k(c,Dk.x,k,Ki,Gr,wi,bb,Ci,In,Wc,Fe):t.$10k(c,Dk.y,k,Ki,Gr,wi,bb,Ci,In,Wc,Fe,X))}}var t=this,A=t.$1k,K=t.$2k,L=t.$3k,x=t.$4k,q=t._topRulerConfig,T=t._rightRulerConfig,X=t._bottomRulerConfig,M=t._leftRulerConfig,V=t._defaultRulerConfig,z=t._component,k=t.getComponentViewRect(z),O=t.getComponentHZoom(z),h=t.getComponentVZoom(z),m=k.x*O,g=m+k.width*O,E=k.y*h,l=E+k.height*h,$=t._defaultRulerConfig.size,Y="defaultMajorTickSpacing",S="maxPhysicalMajorTickSpacing",f="minPhysicalMajorTickSpacing",o="tickSpacingAdaptable",N="majorTickTextFont",W="majorTickTextColor",B="majorTickColor",I="minorTickColor",p="guideVisible",d="guideTipVisible",F="guideTipBorderColor",b="guideTipTextColor",a="guideTipTextFont",R="guideTipBackground",j="guideColor",Z="guideWidth",s="minMajorTickSpacing",Q=V[Y],P=V[S],e=V[f],y=V[o],v=V[N],_=V[W],U=V[B],r=V[s],G=V[I],n=V[p],D=V[d],w=V[F],C=V[b],J=V[a],H=V[R],Hg=V[j],Bl=V[Z];t._view&&z&&(c(A,q,t.$11k,!0,!1,"_currentTopMajorTickSpacing"),c(K,T,t.$12k,!1,!0,"_currentRightMajorTickSpacing"),c(L,X,t.$11k,!0,!0,"_currentBottomMajorTickSpacing"),c(x,M,t.$12k,!1,!1,"_currenLeftMajorTickSpacing"))},$8k:function(g,y,t,X,C){return t>g*X?g=k(y/X/C)*C:g*X>y&&(g=s(t/X/C)*C),g},getHTipText:function(j){var W=this,_=W._component,n=0,J=W._view.getBoundingClientRect();return _.lp?n=o(_.lp({clientX:j.x+J.left,clientY:j.y}).x):n-=o(this.getComponentView(_).style.left)||0,n},$9k:function(Q,U,r,E,j,Y,d,I,W,H,A){var G=this,R=G._component;Q.save(),c.translateAndScale(Q,0,0,1);var b=U-(o(this.getComponentView(R).style.left)||0),v=0;if(U=G.getHTipText(G.$16k),Y&&(Q.beginPath(),Q.fillStyle=E,Q.rect(b,v,j,r),Q.fill()),d){Q.beginPath(),Q.textAlign="center",Q.textBaseline="middle",Q.font=H;var w=Q.measureText(U).width+6;Q.fillStyle=A,Q.rect(b-w/2,v,w,r),Q.fill(),Q.strokeStyle=I,Q.stroke(),Q.beginPath(),Q.fillStyle=W,Q.fillText(U,b,v+r/2)}Q.restore()},getVTipText:function(i){var c=this,Z=c._component,j=0,e=c._view.getBoundingClientRect();return Z.lp?j=o(Z.lp({clientX:i.x,clientY:i.y+e.top}).y):j-=o(this.getComponentView(Z).style.top)||0,j},formatScaleText:function(y){return Math.round(y)},$10k:function(W,j,G,r,C,i,B,$,U,q,w,b){var u=this,V=u._component;W.save(),c.translateAndScale(W,0,0,1);var A=G/2,K=j-(o(this.getComponentView(V).style.top)||0);if(j=u.getVTipText(u.$16k),i&&(W.beginPath(),W.fillStyle=r,W.rect(A-G/2,K,G,C),W.fill()),B){W.translate(A,K),W.rotate((b?90:-90)*R/180),W.translate(-A,-K),W.beginPath(),W.textAlign="center",W.textBaseline="middle",W.font=q;var l=W.measureText(j).width+6;W.fillStyle=w,W.rect(A-l/2,K-G/2,l,G),W.fill(),W.strokeStyle=$,W.stroke(),W.fillStyle=U,W.fillText(j,A,K)}W.restore()},$11k:function(C,I,J,A,v,b,F,x,U,X,n,u,M){C.save(),J=0;var y=I,j=A,h=(y+j)/2;I=0,A=j-y,c.translateAndScale(C,0,0,1);var L=0,Z=0,O=o(b/2),a=b-O,l=n?0:O,Y=x*F,W=Y/10;I-=Y,A+=Y,C.clearRect(I,0,A-I,b),C.beginPath(),C.fillStyle=M;var R=k(h/W)*W-y;for(L=R;A>L;L+=W)C.rect(L,J+l,1,a);for(L=R;L>I;L-=W)C.rect(L,J+l,1,a);for(C.fill(),l=n?0:1,C.beginPath(),C.fillStyle=u,R=k(h/Y)*Y-y,L=R;A>L;L+=Y)C.rect(L,J+l,1,b-1);for(L=R;L>I;L-=Y)C.rect(L,J+l,1,b-1);C.fill();var t=o(/\d+px/.exec(U)[0]),f=(t||10)/2;C.textBaseline="middle",l=n?b-f-2:f+2,C.beginPath(),C.fillStyle=X,C.font=U;var g=k(h/Y)*Y/F;for(L=R,Z=g;A>L;L+=Y,Z+=x){var w=this.getHScaleText?this.getHScaleText(L):Z;C.fillText(this.formatScaleText(w),L+2,J+l)}for(L=R,Z=g;L>I;L-=Y,Z-=x){var w=this.getHScaleText?this.getHScaleText(L):Z;C.fillText(this.formatScaleText(w),L+2,J+l)}C.restore()},$12k:function(v,n,N,T,U,u,t,Q,Z,M,d,O,s){function g(R,$,N,z,C,Z){C=F.getVScaleText?F.getVScaleText(N):C,C=F.formatScaleText(C),v.translate(R+$,N),v.rotate(-z),v.translate(-R-$,-N),v.fillText(C,R+$+(Z?2:1),N),v.translate(R+$,N),v.rotate(z),v.translate(-R-$,-N)}v.save(),n=0;var j=N,Y=U,P=(j+Y)/2;N=0,U=Y-j,c.translateAndScale(v,0,0,1);var I=0,F=this,V=0,H=o(u/2),m=u-H,E=d?0:H,x=Q*t,e=x/10;N-=x,U+=x,v.clearRect(n,0,u,U-N),v.beginPath(),v.fillStyle=s;var w=k(P/e)*e-j;for(I=w;U>I;I+=e)v.rect(n+E,I,m,1);for(I=w;I>N;I-=e)v.rect(n+E,I,m,1);for(v.fill(),E=d?0:1,v.beginPath(),v.fillStyle=O,w=k(P/x)*x-j,I=w;U>I;I+=x)v.rect(n+E,I,u-1,1);for(I=w;I>N;I-=x)v.rect(n+E,I,u-1,1);v.fill();var $=o(/\d+px/.exec(Z)[0]),C=($||10)/2,W=90*R/180;v.textBaseline="middle",E=d?u-C:C+2,W=d?-W:W,v.beginPath(),v.fillStyle=M,v.font=Z;var a=k(P/x)*x/t;for(I=w,V=a;U>I;I+=x,V+=Q)g(n,E,I,W,V,d);for(I=w,V=a;I>N;I-=x,V-=Q)g(n,E,I,W,V,d);v.restore()},onPropertyChanged:function(){this.iv()},dispose:function(){var D=this,l=D._component,P=D._view;l&&D.removeComponentPropertyChangeListener(l,D.$14k),P&&(m(P,"mousemove",D.$15k),d(P.parentNode,P),D._view=null)}})}(this,Object);