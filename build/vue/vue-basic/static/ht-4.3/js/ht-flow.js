!function(D){"use strict";var c="ht",q=D[c],U=q.Default,J=Math,a=J.PI,i=2*a,F=J.sin,T=J.cos,f=J.atan2,V=J.sqrt,k=J.max,A=J.floor,K=(J.round,J.ceil),I=J.abs,j=q.Shape,h=q.Edge,g=q.List,s=q.Style,C=q.graph,d=U.getInternal(),p=d.ui(),z=null,Y="__segmentLengths",t="__lineTotalLength",B="__linePoints",W="__distance0",E="flow.count",u="flow.step",n="flow.element.max",X="flow.element.count",N="flow.element.min",o="flow.element.space",O="flow.element.autorotate",x="flow.element.background",M="flow.element.shadow.max",l="flow.element.shadow.min",G="flow.element.shadow.begincolor",H="flow.element.shadow.endcolor",e="flow.element.shadow.visible",Q="flow.element.image",L="flow",r="prototype",m=function(v){return document.createElement(v)},w=function(L){for(var h=0,j=L.length-1,n=0;j>n;n++){var U=L[n],c=L[n+1],A=c.x-U.x,p=c.y-U.y,Z=V(A*A+p*p);h+=Z}return h},_=function(c,_){for(var H=0,Y=0,y=0,N=c.length-1,j=0;N>j;j++){var g=c[j],r=c[j+1],O=r.x-g.x,L=r.y-g.y;if(y=V(O*O+L*L),H+=y,H>_){H-=y,Y=j;break}}var w=c[Y],x=c[Y+1],m=f(x.y-w.y,x.x-w.x),M=_-H,L=F(m)*M,O=T(m)*M;return{x:w.x+O,y:w.y+L}},$=function(f,M,N,O){var S=T(O),_=F(O),h=S*M-_*N,G=_*M+S*N;return f?{x:f.x+h,y:f.y+G}:{x:h,y:G}},S=function(G,i){G[Y]=G[t]=G[B]=i[W]=z},y=function(Y,q,k,V,M,l){var g,L,$,C,o,J,r,b,W,c,X,t=[];if(I(V)>i&&(V=i),o=K(I(V)/(a/4)),g=V/o,L=-g,$=-k,o>0){J=Y+T(k)*M,r=q+F(-k)*l,t.push({x:J,y:r});for(var n=0;o>n;n++)$+=L,C=$-L/2,b=Y+T($)*M,W=q+F($)*l,c=Y+T(C)*(M/T(L/2)),X=q+F(C)*(l/T(L/2)),t.push({x:c,y:X}),t.push({x:b,y:W})}return t},v=function(P){var T,v,c=P._data;if(c instanceof j){if(T=c.getPoints(),v=c.getSegments(),(!v||0===v.size())&&T){v=new q.List([1]);for(var F=1;F<T.size();F++)v.add(2)}}else if(c instanceof h){var u=P._78o;if(u){var a=u.type,N=u.points,n=u.segments,R=u._4O;if(!a||N){var H=u._69o,o=H.x,K=H.y,C=u._70o,Q=C.x,f=C.y;if(a)n?(T=new g({x:o,y:K}),T.addAll(N),T.add({x:Q,y:f}),v=new g(n._as)):(T=new g({x:o,y:K}),v=new g([1]),N.each(function(j){T.add(j),v.add(2)}),T.add({x:Q,y:f}),v.add(2));else if(u.looped){T=new g(y(o,K,0,i,u.radius,u.radius)),v=new g([1]);for(var F=0;F<(T.size()-1)/2;F++)v.add(3)}else T=new g,u.center?(T.add({x:u.c1.x,y:u.c1.y}),T.add({x:o,y:K}),T.add({x:Q,y:f}),T.add({x:u.c2.x,y:u.c2.y}),v=new g([1,2,2,2])):(T.add({x:o,y:K}),T.add({x:Q,y:f}),v=new g([1,2]))}else if(R)if(T=new g(R.points._as),R.segments)v=new g(R.segments._as);else{v=new g([1]);for(var F=1;F<R.points.size();F++)v.add(2)}}}if(T&&v){for(var x=d.toPointsArray(T._as,v._as,50),S=x.length,L=[],F=0;S>F;F++){var X=x[F];X.length>1&&L.push(x[F])}c.s("flow.reverse")&&(L.reverse(),L.forEach(function(T){T.reverse()}));for(var r=0,O=[],m=L.length,F=0;m>F;F++){var X=L[F],M=w(X);r+=M,O.push(M)}if(c[Y]=O,c[t]=r,c[B]=L,c instanceof h){var z=U.unionPoint(L),_=z.x+z.width/2,V=z.y+z.height/2;c.$10e={x:_,y:V}}b(P,!0)}},b=function(b,d){var h=b._data,v=h[t],S=h.s(E),G=h.s(u),m=0,p=h[Y],z=h.s(n),U=h.s(N),F=h.s(X),Q=(z-U)/(F-1),r=[];if(p){if(1===F)r.push(z);else if(2===F)r.push(z),r.push(U);else{if(!(F>2))return;r.push(z);for(var o=F-2;o>0;o--)r.push(U+Q*o);r.push(U)}var C=0,K=0;r.forEach(function(g){F-1>C&&(K+=h.getFlowElementSpace(g)),C++}),K+=(z+U)/2,m=(v-S*K+K)/S;var l=b[W];for(null==l&&(l=0),d||(l+=G);l>v+K;){var x=b._overCount;x?x++:x=1,x>=S&&(x=null),b._overCount=x,x?l-=m+K:(l=0,h.s("flow.autoreverse")&&h.s("flow.reverse",!h.s("flow.reverse")))}b[W]=l}},P=function(U){var S=U.data,d=this.dm();if(S&&"add"===U.kind){var a=d.$3e;a&&S.s(L)&&a.indexOf(S)<0&&a.push(S)}"clear"===U.kind&&(d.$3e=[])},Z=function(b){var F=b.property,c=b.data,Z=b.newValue,f=this.dm().$3e;if(f&&"s:flow"===F)if(Z)f.indexOf(c)<0&&f.push(c);else for(var M=f.length,z=0;M>z;z++)if(f[z]===c){f.splice(z,1);break}},R=function(P,$){for(var y=0,V=$.length,O=0;V>O;O++){var h=$[O];if(y+=h,y>P)return O}return O},Dq=function(w){var A=this,u=A._data,v=u[t],j=u[Y],p=u[B],J=u.s(E),I=0,x=A[W],L=u.s(n),g=u.s(N),i=u.s(X),Q=u.s(l),S=u.s(M),Z=u.s(O),r=(S-Q)/(i-1),q=(L-g)/(i-1),b=u.getRotation?u.getRotation():0,G=u.getPosition?u.p():u.$10e,y=[],h=[];if(x!=z){if(1===i)y.push(L);else if(2===i)y.push(L),y.push(g);else{if(!(i>2))return;y.push(L);for(var F=i-2;F>0;F--)y.push(g+q*F);y.push(g)}if(1===i)h.push(S);else if(2===i)h.push(S),h.push(Q);else{if(!(i>2))return;h.push(S);for(var F=i-2;F>0;F--)h.push(Q+r*F);h.push(Q)}var T=0,D=0;y.forEach(function(o){i-1>T&&(D+=u.getFlowElementSpace(o)),T++}),D+=(L+g)/2,I=(v-J*D+D)/J,w.save();for(var F=0;J>F;F++){var U=x,m=0,c=A._overCount,a=0;c&&c>J-(F+1)||(U-=F*(I+D),T=0,y.forEach(function(s){var W=U-m;if(W>=0&&v>W){var r=!0,e=R(W,j);a=0;for(var H=0;e>H;H++)a+=j[H];if(W-=a,r){var t=_(p[e],W),L=b;if(Z){for(var J=p[e],D=0,n=0,c=0;c<J.length-1;c++){var l=J[c],o=J[c+1],P=o.x-l.x,I=o.y-l.y,Y=V(P*P+I*I);if(D+=Y,D>W){n=c;break}}var E=J[n];L+=f(t.y-E.y,t.x-E.x)}b&&(t=$(G,t.x-G.x,t.y-G.y,b)),A.$5e(w,t,s,h[T],L)}}m+=u.getFlowElementSpace(y[T]),T++}))}w.restore()}},tm=C.GraphView[r],vm=q.Data[r],bp=p.DataUI[r],lb=p.ShapeUI[r],tr=p.EdgeUI[r],fg=q.DataModel[r],Al=lb._80o,lj=tr._80o,Cj=fg.prepareRemove,br=tr._79o,Gp=lb._79o,Vk=tm.setDataModel,vn=function(){var G=this,k=G._data,g=k.s(n),u=!1,P=z;if(G._6I||(u=!0),P=k instanceof h?br.call(G):Gp.call(G),k.s(L)&&u){var $=k.s(M),W=k.s(e);W&&$>g&&(g=$),g>0&&U.grow(P,K(g/2)),v(G)}return!k.s(L)&&u&&S(k,G),P};vm.getFlowElementSpace=function(){return this.s(o)},lb._79o=vn,tr._79o=vn,s[n]==z&&(s[n]=7),s[N]==z&&(s[N]=0),s[E]==z&&(s[E]=1),s[u]==z&&(s[u]=3),s[X]==z&&(s[X]=10),s[o]==z&&(s[o]=3.5),s[O]==z&&(s[O]=!1),s[x]==z&&(s[x]="rgba(255, 255, 114, 0.4)"),s[G]==z&&(s[G]="rgba(255, 255, 0, 0.3)"),s[H]==z&&(s[H]="rgba(255, 255, 0, 0)"),s[e]==z&&(s[e]=1),s[M]==z&&(s[M]=22),s[l]==z&&(s[l]=4),fg.prepareRemove=function(K){Cj.call(this,K);var X=K._dataModel,C=X.$3e;if(C)for(var s=C.length,R=0;s>R;R++)if(C[R]===K){C.splice(R,1);break}},tm.setDataModel=function(x){var t=this,$=t._dataModel;if($!==x){$&&($.umm(P,t),$.umd(Z,t),$.$3e=[]),x.mm(P,t),x.md(Z,t);var d=x.$3e=[];x.each(function(k){k.s(L)&&d.indexOf(k)<0&&d.push(k)}),Vk.call(t,x)}},tm.setFlowInterval=function(J){var M=this,N=M.$11e;M.$11e=J,M.fp("flowInterval",N,J),M.$7e!=z&&(clearInterval(M.$7e),delete M.$7e,M.enableFlow(J))},tm.getFlowInterval=function(){return this.$11e},tm.$9e=function(){var B,h,t,W=this,Z=W.tx(),o=W.ty(),x=W.getZoom(),F=W.getWidth(),w=W.getHeight(),y={x:-Z/x,y:-o/x,width:F/x,height:w/x},V=W.dm().$3e,H=W._56I,P=new g;if(V.forEach(function(A){H[A.getId()]&&(B=W.getDataUI(A),B&&(t=B._79o(),t&&P.add(t)))}),0!==P.size()&&(P.each(function(d){U.intersectsRect(y,d)&&(h=U.unionRect(h,d))}),h&&(h&&(U.grow(h,k(1,1/x)),h.x=A(h.x*x)/x,h.y=A(h.y*x)/x,h.width=K(h.width*x)/x,h.height=K(h.height*x)/x,h=U.intersection(y,h)),h))){var v=W._canvas.getContext("2d");v.save(),v.lineCap=U.lineCap,v.lineJoin=U.lineJoin,d.translateAndScale(v,Z,o,x),v.beginPath(),v.rect(h.x,h.y,h.width,h.height),v.clip(),v.clearRect(h.x,h.y,h.width,h.height),W.$6e(v,h),v.restore()}},tm.$6e=function($,I){var b,S,g=this;g._93db($),g.each(function(i){g._56I[i._id]&&(b=g.getDataUI(i),b&&(S=b._79o(),(!I||U.intersectsRect(I,S))&&b._42($)))}),g._92db($)},tm.enableFlow=function(x){var t=this,N=t.dm(),e=N.$3e;t.$7e==z&&(e.forEach(function(Q){var w=t.getDataUI(Q);v(w)}),t.$7e=setInterval(function(){e.forEach(function(Q){b(t.getDataUI(Q))}),t.$9e()},x||t.$11e||50))},tm.disableFlow=function(){var j=this;clearInterval(j.$7e),delete j.$7e;var A=j.dm().$3e;A&&j.$9e()},bp.$5e=function(b,l,f,L,X){var v=this,n=v._data,g=v.gv,A=n.s(x),E=n.s(G),I=n.s(H),J=n.s(e),w=g.$8e,M=n.s(Q);if(w==z&&(w=g.$8e={}),b.beginPath(),M!=z){var D=U.getImage(M),C=f/2;b.translate(l.x,l.y),b.rotate(X),b.translate(-l.x,-l.y),U.drawImage(b,D,l.x-C,l.y-C,f,f,n),b.translate(l.x,l.y),b.rotate(-X),b.translate(-l.x,-l.y)}else b.fillStyle=A,b.arc(l.x,l.y,f/2,0,i,!0),b.fill();if(J){var K=22,k=K+"_"+E+"_"+I,S=w[k];if(S==z){var B=m("canvas");d.setCanvas(B,K,K);var h=B.getContext("2d"),c=K/2,r=c,j=c;d.translateAndScale(h,0,0,1),h.beginPath();var N=h.createRadialGradient(r,j,0,r,r,c);N.addColorStop(0,E),N.addColorStop(1,I),h.fillStyle=N,h.arc(r,j,c,0,i,!0),h.fill(),S=w[k]=B}var C=L/2;U.drawImage(b,S,l.x-C,l.y-C,L,L,n)}},tr._80o=function(t){lj.call(this,t);var G=this,X=G._data,P=G.gv;X.s(L)&&P.$7e!=z&&Dq.call(G,t)},lb._80o=function(V){Al.call(this,V);var k=this,O=k._data,t=k.gv;O.s(L)&&t.$7e!=z&&Dq.call(k,V)}}(this,Object);